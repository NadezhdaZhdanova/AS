Описание настройки ОС под конкретный документ ФСТЭК России
https://wiki.astralinux.ru/fstec/security_measures

ОПЕРАЦИОННАЯ СИСТЕМА СПЕЦИАЛЬНОГО НАЗНАЧЕНИЯ «ASTRA LINUX SPECIAL EDITION» Руководство по КСЗ.

Список и статус механизмов безопасности
sudo astra-security-monitor

Хранение паролей
/etc/passwd – информация о пользователе login:зашиврованый пароль:UID:GID:домашняя директория
/etc/passwd-    - бэкап
/etc/shadow   - необязательный файл с шифрованным паролем login:шифрованный пароль\(если ! или * пользователь не может войти в систему под паролем. Но может по ключу):дата последней смены пароля (в днях с 70ого года) 0 – может входить без пароля:мин и макс сроки дейсвия:дата просрочки учётки
root:!:19611:0:99999:7:::
:!: Означет, что у root нет пароля и вход по паролю запрещен.
Но это не означает, что он не может попасть в систему по ключу доступа.
Из-за этого не работает recovery mode

man 5 passwd – нужная страница мануала

Сложность пароля задаться в /etc/pam.d/common-password) в строке password requisite pam cracklib.so параметр minlen=12, dcredit=1, ucredit=1, lcredit=1, ocredit=1
срок действия пароля задается:
- для новых пользователей /etc/login.defs
- для ранее созданных пользователей  файл /etc/shadow пятый по счёту параметр (root:!:19611:0:99999:7:::)


Доменная авторизация 
/etc/nsswitch.conf – откуда берутся файлы для сверки авторотационных данных локально или из внешних файлов
Разблокировка доменных пользователей в два этапа: 1. Разблокировать в домене 2. Разблокировать в pam_tally

PAM(PlugubleAutentifictionModul) – Модули аутентификации
Бинарники, встраивающиеся в систему аутентификации
Сценарии аутентификации (т. е. работа этих функций) описываются в конфигурационном файле /etc/pam.conf и в ряде конфигурационных файлов, расположенных в каталоге /etc/pam.d/. Сама аутентификация выполняется с помощью PAM. Модули располагаются в каталоге /lib/security в виде динамически загружаемых объектных файлов

\etc\pam.d

\etc\pam.d\common-auth    (| grep –v ‘#’ – без комментов)
pam_tally – счётчики неудачной авторизации, разблокировка пользователей
sudo faillog –r  - статистика неудачной авторизации

Управление PAM через графику
Панель управления – Безопасность – Политика безопасности

Управление PAM через Ансибл, Паппет
Делаем комон-ауфф, распостраняем на всех

/etc/pam.d/сommon-password – характеристики локальных паролей

Блокировка экрана
/usr/share/fly-wm/theme.master/themerc
(файл надо создать)

Гарантированное удаление данные
 - зачищать разделы дисков(При включении гарантиронного удаления на диске этой операции подвергаются все процедуры удаления)
 - зачищать раздел подкачки /etc/parsec/swap_wiper.conf
Права доступа
Дискретные права доступа – readwritwexecute
-права на каждый объект
111110000 – минимальный ACL (Access Control List)
Rwxrwxrwx
Хозяин группа хозяина все остальные
ls –l – просмотр прав на объекты в текущей папке
chmod – изменение
Расширенный ACL
User/grop/other/mask:user(group)_name:rwx
getfacl - посмотри права доступа ACL
setfacl - установи права доступа ALC


Мандатный контроль целостности (MIC mandatory integrity control)
Защита системных файлов от несанкционированной записи
Linux Security Modules – в Астре  Parsec 
64 иерархических уровня целостности (0 – Низкий (для обычных пользователей), 1- сетевые сервисы, 2 – уровень вертуализации…., 63 – Высоокий(полный доступ с модификацией системных файлов)
Процесс наследует метку целостности от оунера
Grep “parsec” /boot/grub/grub.cfg
Parsec.max_ilev=63  - 63 – уровень целостности
Parsec.strict_mode=1 – если включено.  параметр отсутсвует, если выклбючено

128 неиерархических

Мандатное управление доступом (Mandatory Access Control)
Пользователи ОС не определяют доступ субъекта к объектам.
в Астре  Parsec
Уровни конфиденциальности. До 255 иерархических уровней (обычно 4. 3 – очень важная, …, 0 – открытая. )
Категории конфиденциальности. До 64 неиерархических категорий. (например кадры, финансы, закупки и тп)
Из терминала:
/home/<user> pdpl-user <user> - lдля пользователя
pdp-ls –M /etc/ - для файлов (в данном случае каталога etc)
pdpl-ps <№процесса> - для процессов
Из графики:
Системный монитор – таблица процессов – столбец Контекст MAC      -   для процессов
Для образа диска:
/home/<user> cat /etc/parsec/micdb/1000


Замкнутая программная среда
Запрещает запуск исполняемых файлов и импорт разделяемых библиотек
Два режима работы:
1.	Запрещает запуск
2.	Отладочный режим

Через графику:
Панель управления – управление политикой безопасности - замкнутая программная среда
Из консоли:
Astra-digsig-control status
Из образа диска:
Cat /etc/digsig/digsig_intramfs.conf

Digsig_elf_modde=1 (0 выключен, 1 включен, 2 отладочный режим)

Запуск приложений с промежуточным уровнем целостности
Hardened ядро
Рендомизированное адресное пространство
Запрет записи в испольняемые области памяти
Блокировка консоли, макросов, интерпритаторов
Запрет установки бита исполнения
Системный и графический киоск
Блокировка ptrace
